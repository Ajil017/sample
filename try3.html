<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Memory Journey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
            transition: background 2s ease;
        }

        .background-changer {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            gap: 10px;
        }

        .color-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .color-btn:hover {
            transform: scale(1.2);
            border-color: rgba(255,255,255,0.8);
        }

        .floating-hearts {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .heart {
            position: absolute;
            color: rgba(255,255,255,0.3);
            font-size: 20px;
            animation: float 8s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100px) rotate(360deg);
                opacity: 0;
            }
        }

        .journey-container {
            position: relative;
            z-index: 2;
            padding: 40px 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .title {
            text-align: center;
            color: white;
            font-size: 3em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInDown 1s ease-out;
        }

        .subtitle {
            text-align: center;
            color: rgba(255,255,255,0.9);
            font-size: 1.2em;
            margin-bottom: 60px;
            font-style: italic;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .path-container {
            position: relative;
            margin: 40px 0;
            padding: 40px;
            height: 200vh;
            width: 100%;
        }

        .path-line {
            position: absolute;
            width: 6px;
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
            z-index: 1;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
        }

        .s-path {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }

        .s-path svg {
            width: 100%;
            height: 100%;
        }

        .path-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4, #ffeaa7);
            border-radius: 3px;
            width: 0%;
            transition: width 1s ease;
            position: relative;
            overflow: hidden;
        }

        .path-progress::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .milestones {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 5;
        }

        .milestone {
            position: absolute;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .milestone.locked {
            cursor: not-allowed;
            opacity: 0.5;
        }

        .milestone.unlocked:hover {
            transform: scale(1.15) translateY(-10px);
        }

        .milestone-icon {
            width: 100px;
            height: 100px;
            border-radius: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            border: 4px solid rgba(255,255,255,0.4);
            transition: all 0.4s ease;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            position: relative;
            overflow: hidden;
        }

        .milestone.locked .milestone-icon {
            background: linear-gradient(135deg, #95a5a6 0%, #7f8c8d 100%);
            border-color: rgba(255,255,255,0.2);
        }

        .milestone.unlocked .milestone-icon:hover {
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: rgba(255,255,255,0.8);
        }

        .milestone-icon::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            transform: rotate(45deg);
            transition: all 0.6s ease;
            opacity: 0;
        }

        .milestone.unlocked:hover .milestone-icon::before {
            opacity: 1;
            animation: shine 0.6s ease;
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        .lock-icon {
            position: absolute;
            top: -10px;
            right: -10px;
            width: 30px;
            height: 30px;
            background: #e74c3c;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1em;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .milestone-label {
            position: absolute;
            top: 120px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            color: #333;
            white-space: nowrap;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.4s ease;
            opacity: 0;
            transform: translateX(-50%) translateY(20px);
        }

        .milestone.unlocked:hover .milestone-label {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        .traveler-pointer {
            position: absolute;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #ffeaa7 0%, #fab1a0 100%);
            border-radius: 50% 50% 50% 0;
            transition: all 0.3s ease;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border: 3px solid rgba(255,255,255,0.6);
            animation: pointerGlow 2s infinite alternate;
        }

        @keyframes pointerGlow {
            0% { box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
            100% { box-shadow: 0 6px 25px rgba(255,235,59,0.6); }
        }

        .traveler-pointer::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }

        .content-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
            backdrop-filter: blur(5px);
        }

        .content-modal.show {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 25px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 25px 70px rgba(0,0,0,0.3);
            transform: scale(0.8) rotateY(-15deg);
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .content-modal.show .modal-content {
            transform: scale(1) rotateY(0deg);
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            background: none;
            border: none;
            font-size: 2em;
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.1);
            transform: rotate(90deg);
        }

        .modal-header {
            color: white;
            font-size: 2.2em;
            margin-bottom: 25px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: fadeInDown 0.6s ease-out;
        }

        .modal-body {
            color: rgba(255,255,255,0.95);
            font-size: 1.1em;
            line-height: 1.8;
            text-align: center;
            animation: fadeInUp 0.6s ease-out 0.2s both;
        }

        .progress-indicator {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.95);
            padding: 15px 30px;
            border-radius: 30px;
            color: #333;
            font-weight: bold;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            z-index: 10;
            transition: all 0.3s ease;
            border: 2px solid rgba(255,255,255,0.3);
        }

        .error-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 30px 40px;
            border-radius: 20px;
            font-size: 1.2em;
            text-align: center;
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            transform: translate(-50%, -50%) scale(0.8);
            border: 2px solid rgba(255,255,255,0.2);
        }

        .error-message.show {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            z-index: 100;
        }

        .control-row {
            display: flex;
            gap: 5px;
            justify-content: center;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.9);
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5em;
            color: #333;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            user-select: none;
        }

        .control-btn:hover {
            background: white;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.2);
        }

        .control-btn:active {
            transform: scale(0.95);
        }
            .title {
                font-size: 2.2em;
            }
            
            .path-container {
                padding: 20px;
                height: 250vh;
            }
            
            .controls {
                bottom: 80px;
                right: 10px;
            }
            
            .control-btn {
                width: 45px;
                height: 45px;
                font-size: 1.2em;
            }
            
            .milestone-icon {
                width: 80px;
                height: 80px;
                font-size: 2em;
            }
        
    </style>
</head>
<body>
    <div class="background-changer">
        <div class="color-btn" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);" onclick="changeBackground('pink')"></div>
        <div class="color-btn" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);" onclick="changeBackground('mint')"></div>
        <div class="color-btn" style="background: linear-gradient(135deg, #d299c2 0%, #fef9d7 100%);" onclick="changeBackground('lavender')"></div>
        <div class="color-btn" style="background: linear-gradient(135deg, #89f7fe 0%, #66a6ff 100%);" onclick="changeBackground('ocean')"></div>
        <div class="color-btn" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);" onclick="changeBackground('sunset')"></div>
    </div>

    <div class="controls">
        <div class="control-row">
            <div class="control-btn" id="upBtn">‚Üë</div>
        </div>
        <div class="control-row">
            <div class="control-btn" id="leftBtn">‚Üê</div>
            <div class="control-btn" id="downBtn">‚Üì</div>
            <div class="control-btn" id="rightBtn">‚Üí</div>
        </div>
    </div>

    <div class="floating-hearts"></div>
    
    <div class="journey-container">
        <h1 class="title">Memory Journey</h1>
        <p class="subtitle">Travel through the path of cherished moments</p>
        
        <div class="path-container">
            <div class="s-path">
                <svg id="pathSvg" viewBox="0 0 800 1600">
                    <path id="sPath" d="M 100 100 Q 600 200 700 400 Q 800 600 200 800 Q -100 1000 100 1200 Q 300 1400 700 1500" 
                          stroke="rgba(255,255,255,0.3)" stroke-width="6" fill="none"/>
                    <path id="progressPath" d="M 100 100 Q 600 200 700 400 Q 800 600 200 800 Q -100 1000 100 1200 Q 300 1400 700 1500" 
                          stroke="url(#gradient)" stroke-width="6" fill="none" 
                          pathLength="100" stroke-dasharray="0 100"/>
                    <defs>
                        <linearGradient id="gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:#ff6b6b"/>
                            <stop offset="25%" style="stop-color:#4ecdc4"/>
                            <stop offset="50%" style="stop-color:#45b7d1"/>
                            <stop offset="75%" style="stop-color:#96ceb4"/>
                            <stop offset="100%" style="stop-color:#ffeaa7"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            <div class="traveler-pointer" id="travelerPointer"></div>
            
            <div class="milestones" id="milestonesContainer">
                <!-- Milestones will be positioned dynamically -->
            </div>
        </div>
        
        <div class="progress-indicator" id="progressIndicator">
            Start your journey by clicking the first milestone
        </div>
    </div>

    <div class="content-modal" id="contentModal">
        <div class="modal-content">
            <button class="close-btn" onclick="closeModal()">&times;</button>
            <h2 class="modal-header" id="modalHeader"></h2>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>
    
    <div class="error-message" id="errorMessage">
        <p>It can't be easily finished, enjoy each and every moment! üíï</p>
    </div>

    <script>
        const milestones = [
            {
                title: "First Light",
                content: "Every journey begins with a single step. This is where our story started - with hope, dreams, and the courage to begin something beautiful. The morning sun reminds us that every day brings new possibilities and chances to create wonderful memories together.",
                icon: "üåÖ",
                position: { x: 100, y: 100 }
            },
            {
                title: "Morning Coffee",
                content: "Those quiet mornings when the world feels perfect. Sharing coffee, sleepy conversations, and the gentle warmth of being together. These simple moments become the foundation of our beautiful story.",
                icon: "‚òï",
                position: { x: 350, y: 160 }
            },
            {
                title: "First Adventure",
                content: "Stepping out into the world together, hand in hand. Every new place explored, every laugh shared, every moment of wonder - building our collection of precious memories.",
                icon: "üó∫Ô∏è",
                position: { x: 650, y: 250 }
            },
            {
                title: "Special Moments",
                content: "Life is made up of countless small moments that become precious memories. Those quiet conversations, shared laughter, unexpected surprises, and gentle gestures that make the heart flutter.",
                icon: "üíù",
                position: { x: 920, y: 400 }
            },
            {
                title: "Cozy Evenings",
                content: "Candlelit dinners, movie nights, and conversations that last until dawn. Finding comfort in each other's presence and creating a sanctuary of love and understanding.",
                icon: "üïØÔ∏è",
                position: { x: 1000, y: 550 }
            },
            {
                title: "Blooming Love",
                content: "Like flowers in spring, love grows and blossoms in the most beautiful ways. Through seasons of joy and challenge, care and understanding, we've nurtured something truly special.",
                icon: "üå∏",
                position: { x: 900, y: 700 }
            },
            {
                title: "Dancing Hearts",
                content: "Whether it's dancing in the kitchen or swaying under the stars, every moment of joy shared together makes our hearts sing in perfect harmony.",
                icon: "üíÉ",
                position: { x: 600, y: 850 }
            },
            {
                title: "Shining Together",
                content: "Together we shine brighter than we ever could alone. Supporting each other's dreams, celebrating victories, and finding strength in unity. Like stars in the night sky, we illuminate each other's path.",
                icon: "‚≠ê",
                position: { x: 320, y: 1000 }
            },
            {
                title: "Dreaming Forward",
                content: "Planning our future together, sharing dreams and aspirations. Every conversation about tomorrow brings us closer and fills our hearts with excitement for what's to come.",
                icon: "üåô",
                position: { x: 220, y: 1160 }
            },
            {
                title: "Beautiful Future",
                content: "The horizon stretches endlessly before us, painted with the colors of possibility. Our journey continues with excitement for all the adventures, discoveries, and precious moments yet to come.",
                icon: "üåà",
                position: { x: 300, y: 1380 }
            },
             {
                title: "Another Step",
                content: "The horizon stretches endlessly before us, painted with the colors of possibility. Our journey continues with excitement for all the adventures, discoveries, and precious moments yet to come.",
                icon: "ü§ù",
                position: { x: 500, y: 1550 }
            },
             {
                title: "Memory never leaves",
                content: "The horizon stretches endlessly before us, painted with the colors of possibility. Our journey continues with excitement for all the adventures, discoveries, and precious moments yet to come.",
                icon: "‚ú®",
                position: { x: 700, y: 1680 }
            },
             {
                title: "You need an end?",
                content: "The horizon stretches endlessly before us, painted with the colors of possibility. Our journey continues with excitement for all the adventures, discoveries, and precious moments yet to come.",
                icon: "‚ùå",
                position: { x: 1000, y: 1710 }
            },
        ];

        let currentMilestone = 0;
        let visitedMilestones = new Set();
        let currentPathPosition = 0;
        let pathLength = 0;
        let pathElement = null;

        const backgrounds = {
            pink: 'linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%)',
            mint: 'linear-gradient(135deg, #a8edea 0%, #fed6e3 50%, #fed6e3 100%)',
            lavender: 'linear-gradient(135deg, #d299c2 0%, #fef9d7 50%, #fef9d7 100%)',
            ocean: 'linear-gradient(135deg, #89f7fe 0%, #66a6ff 50%, #66a6ff 100%)',
            sunset: 'linear-gradient(135deg, #ffecd2 0%, #fcb69f 50%, #fcb69f 100%)'
        };

        function changeBackground(color) {
            document.body.style.background = backgrounds[color];
        }

        function createFloatingHearts() {
            const heartsContainer = document.querySelector('.floating-hearts');
            const hearts = ['üíï', 'üíñ', 'üíó', 'üíô', 'üíú', 'ü§ç', 'üíõ'];
            
            setInterval(() => {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                heart.style.left = Math.random() * 100 + '%';
                heart.style.animationDuration = (Math.random() * 3 + 5) + 's';
                heart.style.fontSize = (Math.random() * 10 + 15) + 'px';
                heartsContainer.appendChild(heart);

                setTimeout(() => {
                    heart.remove();
                }, 8000);
            }, 1000);
        }

        function initializePath() {
            pathElement = document.getElementById('sPath');
            pathLength = pathElement.getTotalLength();
            
            // Position traveler at start
            const startPoint = pathElement.getPointAtLength(0);
            const traveler = document.getElementById('travelerPointer');
            traveler.style.left = startPoint.x + 'px';
            traveler.style.top = startPoint.y + 'px';
            
            // Create milestones
            createMilestones();
        }

        function createMilestones() {
            const container = document.getElementById('milestonesContainer');
            
            milestones.forEach((milestone, index) => {
                const milestoneEl = document.createElement('div');
                milestoneEl.className = index === 0 ? 'milestone unlocked' : 'milestone locked';
                milestoneEl.setAttribute('data-milestone', index);
                milestoneEl.style.left = milestone.position.x - 50 + 'px';
                milestoneEl.style.top = milestone.position.y - 50 + 'px';
                
                const icon = document.createElement('div');
                icon.className = 'milestone-icon';
                icon.textContent = milestone.icon;
                
                const label = document.createElement('div');
                label.className = 'milestone-label';
                label.textContent = milestone.title;
                
                milestoneEl.appendChild(icon);
                milestoneEl.appendChild(label);
                
                if (index > 0) {
                    const lock = document.createElement('div');
                    lock.className = 'lock-icon';
                    lock.textContent = 'üîí';
                    milestoneEl.appendChild(lock);
                }
                
                container.appendChild(milestoneEl);
            });
        }

        function movePointer(direction) {
            const moveDistance = 20;
            let newPosition = currentPathPosition;
            
            switch(direction) {
                case 'up':
                    newPosition = Math.max(0, currentPathPosition - moveDistance);
                    break;
                case 'down':
                    newPosition = Math.min(pathLength, currentPathPosition + moveDistance);
                    break;
                case 'left':
                    newPosition = Math.max(0, currentPathPosition - moveDistance);
                    break;
                case 'right':
                    newPosition = Math.min(pathLength, currentPathPosition + moveDistance);
                    break;
            }
            
            if (newPosition !== currentPathPosition) {
                currentPathPosition = newPosition;
                updatePointerPosition();
                updatePathProgress();
                checkMilestoneProximity();
            }
        }

        function updatePointerPosition() {
            const point = pathElement.getPointAtLength(currentPathPosition);
            const traveler = document.getElementById('travelerPointer');
            traveler.style.left = point.x + 'px';
            traveler.style.top = point.y + 'px';
        }

        function updatePathProgress() {
            const progressPath = document.getElementById('progressPath');
            const progressPercentage = (currentPathPosition / pathLength) * 100;
            progressPath.style.strokeDasharray = `${progressPercentage} ${100 - progressPercentage}`;
        }

        function checkMilestoneProximity() {
            const currentPoint = pathElement.getPointAtLength(currentPathPosition);
            
            milestones.forEach((milestone, index) => {
                const distance = Math.sqrt(
                    Math.pow(currentPoint.x - milestone.position.x, 2) + 
                    Math.pow(currentPoint.y - milestone.position.y, 2)
                );
                
                if (distance < 60) { // Close enough to milestone
                    const milestoneEl = document.querySelector(`[data-milestone="${index}"]`);
                    if (milestoneEl && milestoneEl.classList.contains('unlocked')) {
                        milestoneEl.style.transform = 'scale(1.2)';
                        milestoneEl.style.zIndex = '20';
                    }
                } else {
                    const milestoneEl = document.querySelector(`[data-milestone="${index}"]`);
                    if (milestoneEl) {
                        milestoneEl.style.transform = '';
                        milestoneEl.style.zIndex = '';
                    }
                }
            });
        }

        function setupControls() {
            // Touch controls
            document.getElementById('upBtn').addEventListener('click', () => movePointer('up'));
            document.getElementById('downBtn').addEventListener('click', () => movePointer('down'));
            document.getElementById('leftBtn').addEventListener('click', () => movePointer('left'));
            document.getElementById('rightBtn').addEventListener('click', () => movePointer('right'));
            
            // Keyboard controls
            document.addEventListener('keydown', (e) => {
                switch(e.key) {
                    case 'ArrowUp':
                        e.preventDefault();
                        movePointer('up');
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        movePointer('down');
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        movePointer('left');
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        movePointer('right');
                        break;
                }
            });
        }

        function unlockNextMilestone(currentIndex) {
            if (currentIndex + 1 < milestones.length) {
                const nextMilestone = document.querySelector(`[data-milestone="${currentIndex + 1}"]`);
                nextMilestone.classList.remove('locked');
                nextMilestone.classList.add('unlocked');
                nextMilestone.querySelector('.lock-icon').remove();
                
                // Add unlock animation
                nextMilestone.style.animation = 'unlockAnimation 0.6s ease-out';
                setTimeout(() => {
                    nextMilestone.style.animation = '';
                }, 600);
            }
        }

        function showMilestoneContent(index) {
            if (index === milestones.length - 1 && !confirm("Are you sure you want to finish this beautiful journey?")) {
                showErrorMessage();
                return;
            }

            const modal = document.getElementById('contentModal');
            const header = document.getElementById('modalHeader');
            const body = document.getElementById('modalBody');
            
            header.textContent = milestones[index].title;
            body.textContent = milestones[index].content;
            
            modal.classList.add('show');
            visitedMilestones.add(index);
            updateProgress();
            unlockNextMilestone(index);
        }

        function closeModal() {
            document.getElementById('contentModal').classList.remove('show');
        }

        function showErrorMessage() {
            const errorMsg = document.getElementById('errorMessage');
            errorMsg.classList.add('show');
            setTimeout(() => {
                errorMsg.classList.remove('show');
            }, 3000);
        }

        function updateProgress() {
            const progressIndicator = document.getElementById('progressIndicator');
            const totalMilestones = milestones.length;
            const visitedCount = visitedMilestones.size;
            
            if (visitedCount === 0) {
                progressIndicator.textContent = "Start your journey by clicking the first milestone";
            } else if (visitedCount === totalMilestones) {
                progressIndicator.textContent = "Journey complete! But the memories live on forever üíï";
            } else {
                progressIndicator.textContent = `Memories discovered: ${visitedCount}/${totalMilestones} - Continue your journey!`;
            }
        }

        function initializeMilestones() {
            const milestoneElements = document.querySelectorAll('.milestone');
            
            milestoneElements.forEach((milestone, index) => {
                milestone.addEventListener('click', () => {
                    if (milestone.classList.contains('locked')) {
                        milestone.style.animation = 'shake 0.5s ease-in-out';
                        setTimeout(() => {
                            milestone.style.animation = '';
                        }, 500);
                        return;
                    }

                    // Check if pointer is close enough
                    const currentPoint = pathElement.getPointAtLength(currentPathPosition);
                    const milestonePos = milestones[index].position;
                    const distance = Math.sqrt(
                        Math.pow(currentPoint.x - milestonePos.x, 2) + 
                        Math.pow(currentPoint.y - milestonePos.y, 2)
                    );
                    
                    if (distance < 60) {
                        showMilestoneContent(index);
                    }
                });
            });
        }

        // Add CSS for animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes unlockAnimation {
                0% { transform: scale(1) rotate(0deg); }
                25% { transform: scale(1.1) rotate(-5deg); }
                50% { transform: scale(1.2) rotate(5deg); }
                75% { transform: scale(1.1) rotate(-2deg); }
                100% { transform: scale(1) rotate(0deg); }
            }
            
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
                20%, 40%, 60%, 80% { transform: translateX(5px); }
            }
        `;
        document.head.appendChild(style);

        // Close modal when clicking outside
        document.getElementById('contentModal').addEventListener('click', (e) => {
            if (e.target.id === 'contentModal') {
                closeModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // Initialize everything
        document.addEventListener('DOMContentLoaded', () => {
            createFloatingHearts();
            initializePath();
            initializeMilestones();
            setupControls();
            updateProgress();
        });
    </script>
</body>
</html>